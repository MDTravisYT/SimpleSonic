VBLANK:
		MOVEM.L	D0-D7/A0-A6,	-(SP)
		TST.B	VBLANKCMD
		BEQ.S	.END
		MOVE.W	(VDPCTRL).L,	D0
		MOVE.L	#$40000010,	(VDPCTRL).L
		MOVE.L	VDP_SCREENPOSY,	(VDPDATA).L
		BTST	#6,	HARDWAREVERSION
		BEQ.S	.NTSC
		MOVE.W	#$700,	D0
		
	.PAL:
		DBF	D0,	.PAL
		
	.NTSC:
		MOVE.B	VBLANKCMD,	D0
		MOVE.B	#0,	VBLANKCMD
		MOVE.W	#1,	HBLANKFLAG
		ANDI.W	#%111110,	D0
		MOVE.W	.INDEX(PC,D0.W),	D0
		JSR		.INDEX(PC,D0.W)
		
	.END:
		ADDQ.L	#1,	VBLANKCOUNTER
	;	JSR		
		MOVEM.L	(SP)+,	D0-D7/A0-A6
		RTE
		
	VBL_INVALID:
		RTS
		
	.INDEX:
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX
		DC.W	VBL_INVALID-.INDEX